#그래프 표시 ggplot을 이용해서 그래프 표시, geom_bar를 사용해서 그래프형식으로 만들었다가 coord_polar를 이용해서 pie형식으로 변환,
#geom_text를 이용해서 value의 시간 표시하고 theme_void()를 사용해서 깔끔하게 보이게 함, labs를 이용해 제목표시 했으며 theme을 이용해 제목을 가운데 정렬 했음
ggplot(sexvalue,aes(x = "", y = DayUsedTime, fill = 성별)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y") + geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(성별)") + theme(plot.title = element_text(hjust = 0.6))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6))
ggplot(incomevalue,aes(x = "", y = DayUsedTime, fill = 소득별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")), position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(소득별)") + theme(plot.title = element_text(hjust = 0.6))
##+ labs(title = "서울시 1일 평균 인터넷 사용시간(성별)")
#그래프 표시 ggplot을 이용해서 그래프 표시, geom_bar를 사용해서 그래프형식으로 만들었다가 coord_polar를 이용해서 pie형식으로 변환,
#geom_text를 이용해서 value의 시간 표시하고 theme_void()를 사용해서 깔끔하게 보이게 함, labs를 이용해 제목표시 했으며 theme을 이용해 제목을 가운데 정렬 했음
ggplot(sexvalue,aes(x = "", y = DayUsedTime, fill = 성별)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y") + geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(성별)") + theme(plot.title = element_text(hjust = 0.6))
ggplot(agevalue,aes(x = "", y = DayUsedTime, fill = 연령별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(연령별)") + theme(plot.title = element_text(hjust = 0.6))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6))
ggplot(incomevalue,aes(x = "", y = DayUsedTime, fill = 소득별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")), position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(소득별)") + theme(plot.title = element_text(hjust = 0.6))
ggplot(marriagevalue,aes(x = "",y = DayUsedTime, fill = 혼인상태별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")), position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(혼인상태별)") + theme(plot.title = element_text(hjust = 0.6))
ggplot(areavalue,aes(x = "", y = DayUsedTime, fill = 지역대분류)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")), position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(지역대분류)") + theme(plot.title = element_text(hjust = 0.6))
ggplot(agevalue,aes(x = "", y = DayUsedTime, fill = 연령별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(연령별)") + theme(plot.title = element_text(hjust = 0.6))
library(ggmap)
library(ggplot2)
library(raster)
library(rgeos)
library(maptools)
library(rgdal)
library(ggmap)
register_google(key = 'AIzaSyClyDsfhdF4-XZcaBQOY-mKj1rmp4LM2NE')
##----------------------------data test-------------------------
map <- shapefile("~/GitHub/Yonsai_IT_Academy/firstStep/teamproject/SIG_201703/TL_SCCO_SIG.shp")
map <- spTransform(map, CRSobj = CRS('+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs'))
new_map <- fortify(map, region = "SIG_CD")
View(new_map)
new_map$id <- as.numeric(new_map$id)
seoul_map <- new_map[new_map$id <= 11740,]
View(seoul_map)
library(readxl)
data <- read_xls("~/GitHub/Yonsai_IT_Academy/firstStep/teamproject/Report.xls")
View(data)
internet_data <- data
library(dplyr)
##Report.xls에사 대분류에서 구로 끝나는 데이터 행 추출
internet_data <- internet_data[grep("구", internet_data$대분류),]
View(internet_data)
##구로 끝나는 데이터 행에서 1~3까지 데이터 열만 추출
internet_data <- internet_data[,c(1:3)]
View(internet_data)
##분류(2열) 열 삭제
internet_data <- internet_data[,-c(2)]
View(internet_data)
##인터넷 데이터의 "1일평균사용시간(시간) 열 이름을 "하루평균사용시간"으로 변경
##변경 이유 : string + int가 합쳐져 1이 int로 인식
internet_data <- rename(internet_data,"하루평균사용시간" = "1일평균사용시간(시간)")
##맵데이터와 internet_data를 연결하기 위해 id 값을 추가
internet_data[,'id'] <- c(11110,11140, 11170, 11200, 11215, 11230, 11260, 11290, 11305, 11320, 11350, 11380, 11410, 11440, 11470, 11500, 11530, 11545, 11560, 11590, 11620, 11650, 11680, 11710, 11740)
View(internet_data)
##seoul_map과 internet_data 값을 id로 병합 연결
merge_result <- merge(seoul_map, internet_data, by="id")
View(merge_result)
map_g <- ggplot() + geom_polygon(data=merge_result, aes(x=long, y=lat, group=group, fill=하루평균사용시간), color = 'white') + labs(x='위도', y='경도', fill='인터넷 하루평균사용시간') + scale_fill_gradient(low='#4374D9', high='#000042')
map_g
##지도에 text 삽입을 위한 데이터 가공
map_text <- internet_data
map_text[,'lat'] <- c(mean(merge_result[grep("종로구", merge_result$대분류),]$lat), mean(merge_result[grep("중구", merge_result$대분류),]$lat), mean(merge_result[grep("용산구", merge_result$대분류),]$lat)-0.002, mean(merge_result[grep("성동구", merge_result$대분류),]$lat), mean(merge_result[grep("광진구", merge_result$대분류),]$lat), mean(merge_result[grep("동대문구", merge_result$대분류),]$lat), mean(merge_result[grep("중랑구", merge_result$대분류),]$lat), mean(merge_result[grep("성북구", merge_result$대분류),]$lat), mean(merge_result[grep("강북구", merge_result$대분류),]$lat), mean(merge_result[grep("도봉구", merge_result$대분류),]$lat), mean(merge_result[grep("노원구", merge_result$대분류),]$lat), mean(merge_result[grep("은평구", merge_result$대분류),]$lat), mean(merge_result[grep("서대문구", merge_result$대분류),]$lat), mean(merge_result[grep("마포구", merge_result$대분류),]$lat)-0.005, mean(merge_result[grep("양천구", merge_result$대분류),]$lat)-0.01, mean(merge_result[grep("강서구", merge_result$대분류),]$lat), mean(merge_result[grep("구로구", merge_result$대분류),]$lat)+0.005, mean(merge_result[grep("금천구", merge_result$대분류),]$lat)+0.002, mean(merge_result[grep("영등포구", merge_result$대분류),]$lat), mean(merge_result[grep("동작구", merge_result$대분류),]$lat)+0.01, mean(merge_result[grep("관악구", merge_result$대분류),]$lat), mean(merge_result[grep("서초구", merge_result$대분류),]$lat), mean(merge_result[grep("강남구", merge_result$대분류),]$lat), mean(merge_result[grep("송파구", merge_result$대분류),]$lat), mean(merge_result[grep("강동구", merge_result$대분류),]$lat))
map_text[,'long'] <- c(mean(merge_result[grep("종로구", merge_result$대분류),]$long), mean(merge_result[grep("중구", merge_result$대분류),]$long), mean(merge_result[grep("용산구", merge_result$대분류),]$long), mean(merge_result[grep("성동구", merge_result$대분류),]$long)+0.015, mean(merge_result[grep("광진구", merge_result$대분류),]$long), mean(merge_result[grep("동대문구", merge_result$대분류),]$long), mean(merge_result[grep("중랑구", merge_result$대분류),]$long), mean(merge_result[grep("성북구", merge_result$대분류),]$long), mean(merge_result[grep("강북구", merge_result$대분류),]$long), mean(merge_result[grep("도봉구", merge_result$대분류),]$long), mean(merge_result[grep("노원구", merge_result$대분류),]$long)+0.01, mean(merge_result[grep("은평구", merge_result$대분류),]$long), mean(merge_result[grep("서대문구", merge_result$대분류),]$long)-0.005, mean(merge_result[grep("마포구", merge_result$대분류),]$long), mean(merge_result[grep("양천구", merge_result$대분류),]$long)-0.002, mean(merge_result[grep("강서구", merge_result$대분류),]$long), mean(merge_result[grep("구로구", merge_result$대분류),]$long), mean(merge_result[grep("금천구", merge_result$대분류),]$long)+0.002, mean(merge_result[grep("영등포구", merge_result$대분류),]$long)+0.005, mean(merge_result[grep("동작구", merge_result$대분류),]$long), mean(merge_result[grep("관악구", merge_result$대분류),]$long), mean(merge_result[grep("서초구", merge_result$대분류),]$long), mean(merge_result[grep("강남구", merge_result$대분류),]$long), mean(merge_result[grep("송파구", merge_result$대분류),]$long), mean(merge_result[grep("강동구", merge_result$대분류),]$long))
##map_g에 표현하기
map_all <- map_g + geom_text(map_text, mapping = aes(x=long, y=lat, label = paste(대분류)), size=2.3, color = 'white')
map_all
base_map = get_map("seoul", zoom=11, maptype = "hybrid")
ggmap(base_map)
test_map <- ggmap(base_map)+geom_polygon(data=merge_result, aes(x=long, y=lat, group=group, fill=하루평균사용시간),alpha = 0.5, color = 'white') + labs(x='위도', y='경도', fill='하루평균사용시간', color='서울특별시 자치구')+ scale_fill_gradient(low='#4374D9', high='#000042')
test_map
##+ labs(title = "서울시 1일 평균 인터넷 사용시간(성별)")
#그래프 표시 ggplot을 이용해서 그래프 표시, geom_bar를 사용해서 그래프형식으로 만들었다가 coord_polar를 이용해서 pie형식으로 변환,
#geom_text를 이용해서 value의 시간 표시하고 theme_void()를 사용해서 깔끔하게 보이게 함, labs를 이용해 제목표시 했으며 theme을 이용해 제목을 가운데 정렬 했음
ggplot(sexvalue,aes(x = "", y = DayUsedTime, fill = 성별)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y") + geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(성별)") + theme(plot.title = element_text(hjust = 0.6))
##+ labs(title = "서울시 1일 평균 인터넷 사용시간(성별)")
#그래프 표시 ggplot을 이용해서 그래프 표시, geom_bar를 사용해서 그래프형식으로 만들었다가 coord_polar를 이용해서 pie형식으로 변환,
#geom_text를 이용해서 value의 시간 표시하고 theme_void()를 사용해서 깔끔하게 보이게 함, labs를 이용해 제목표시 했으며 theme을 이용해 제목을 가운데 정렬 했음
ggplot(sexvalue,aes(x = "", y = DayUsedTime, fill = 성별)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y") + geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(성별)") + theme(plot.title = element_text(hjust = 0.6))
loadfonts(device="win")
install.packages("extrafont")
library(extrafont)
loadfonts(device = "win")
##+ labs(title = "서울시 1일 평균 인터넷 사용시간(성별)")
#그래프 표시 ggplot을 이용해서 그래프 표시, geom_bar를 사용해서 그래프형식으로 만들었다가 coord_polar를 이용해서 pie형식으로 변환,
#geom_text를 이용해서 value의 시간 표시하고 theme_void()를 사용해서 깔끔하게 보이게 함, labs를 이용해 제목표시 했으며 theme을 이용해 제목을 가운데 정렬 했음
ggplot(sexvalue,aes(x = "", y = DayUsedTime, fill = 성별)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y") + geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(성별)") + theme(plot.title = element_text(hjust = 0.6, family = "Sunflower"))
##+ labs(title = "서울시 1일 평균 인터넷 사용시간(성별)")
#그래프 표시 ggplot을 이용해서 그래프 표시, geom_bar를 사용해서 그래프형식으로 만들었다가 coord_polar를 이용해서 pie형식으로 변환,
#geom_text를 이용해서 value의 시간 표시하고 theme_void()를 사용해서 깔끔하게 보이게 함, labs를 이용해 제목표시 했으며 theme을 이용해 제목을 가운데 정렬 했음
ggplot(sexvalue,aes(x = "", y = DayUsedTime, fill = 성별)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y") + geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(성별)") + theme(plot.title = element_text(hjust = 0.6, family = "AdobeHeitiStd-Regular"))
font_install()
font_install()
##+ labs(title = "서울시 1일 평균 인터넷 사용시간(성별)")
#그래프 표시 ggplot을 이용해서 그래프 표시, geom_bar를 사용해서 그래프형식으로 만들었다가 coord_polar를 이용해서 pie형식으로 변환,
#geom_text를 이용해서 value의 시간 표시하고 theme_void()를 사용해서 깔끔하게 보이게 함, labs를 이용해 제목표시 했으며 theme을 이용해 제목을 가운데 정렬 했음
ggplot(sexvalue,aes(x = "", y = DayUsedTime, fill = 성별)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y") + geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(성별)") + theme(plot.title = element_text(hjust = 0.6, family = "Britannic"))
##+ labs(title = "서울시 1일 평균 인터넷 사용시간(성별)")
#그래프 표시 ggplot을 이용해서 그래프 표시, geom_bar를 사용해서 그래프형식으로 만들었다가 coord_polar를 이용해서 pie형식으로 변환,
#geom_text를 이용해서 value의 시간 표시하고 theme_void()를 사용해서 깔끔하게 보이게 함, labs를 이용해 제목표시 했으며 theme을 이용해 제목을 가운데 정렬 했음
ggplot(sexvalue,aes(x = "", y = DayUsedTime, fill = 성별)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y") + geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(성별)") + theme(plot.title = element_text(hjust = 0.6, family = "Britannic Bold"))
##+ labs(title = "서울시 1일 평균 인터넷 사용시간(성별)")
#그래프 표시 ggplot을 이용해서 그래프 표시, geom_bar를 사용해서 그래프형식으로 만들었다가 coord_polar를 이용해서 pie형식으로 변환,
#geom_text를 이용해서 value의 시간 표시하고 theme_void()를 사용해서 깔끔하게 보이게 함, labs를 이용해 제목표시 했으며 theme을 이용해 제목을 가운데 정렬 했음
ggplot(sexvalue,aes(x = "", y = DayUsedTime, fill = 성별)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y") + geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(성별)") + theme(plot.title = element_text(hjust = 0.6, family = "BRITAMIC.TTF"))
##+ labs(title = "서울시 1일 평균 인터넷 사용시간(성별)")
#그래프 표시 ggplot을 이용해서 그래프 표시, geom_bar를 사용해서 그래프형식으로 만들었다가 coord_polar를 이용해서 pie형식으로 변환,
#geom_text를 이용해서 value의 시간 표시하고 theme_void()를 사용해서 깔끔하게 보이게 함, labs를 이용해 제목표시 했으며 theme을 이용해 제목을 가운데 정렬 했음
ggplot(sexvalue,aes(x = "", y = DayUsedTime, fill = 성별)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y") + geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(성별)") + theme(plot.title = element_text(hjust = 0.6, family = "BRITAMIC"))
library(showtext)
font_add_google('Noto Sans KR', 'notosanskr')
##+ labs(title = "서울시 1일 평균 인터넷 사용시간(성별)")
#그래프 표시 ggplot을 이용해서 그래프 표시, geom_bar를 사용해서 그래프형식으로 만들었다가 coord_polar를 이용해서 pie형식으로 변환,
#geom_text를 이용해서 value의 시간 표시하고 theme_void()를 사용해서 깔끔하게 보이게 함, labs를 이용해 제목표시 했으며 theme을 이용해 제목을 가운데 정렬 했음
ggplot(sexvalue,aes(x = "", y = DayUsedTime, fill = 성별)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y") + geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(성별)") + theme(plot.title = element_text(hjust = 0.6, family = "notosanskr"))
##+ labs(title = "서울시 1일 평균 인터넷 사용시간(성별)")
#그래프 표시 ggplot을 이용해서 그래프 표시, geom_bar를 사용해서 그래프형식으로 만들었다가 coord_polar를 이용해서 pie형식으로 변환,
#geom_text를 이용해서 value의 시간 표시하고 theme_void()를 사용해서 깔끔하게 보이게 함, labs를 이용해 제목표시 했으며 theme을 이용해 제목을 가운데 정렬 했음
ggplot(sexvalue,aes(x = "", y = DayUsedTime, fill = 성별)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y") + geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(성별)") + theme(plot.title = element_text(hjust = 0.6))
showtext.auto()
showtext_auto()
##+ labs(title = "서울시 1일 평균 인터넷 사용시간(성별)")
#그래프 표시 ggplot을 이용해서 그래프 표시, geom_bar를 사용해서 그래프형식으로 만들었다가 coord_polar를 이용해서 pie형식으로 변환,
#geom_text를 이용해서 value의 시간 표시하고 theme_void()를 사용해서 깔끔하게 보이게 함, labs를 이용해 제목표시 했으며 theme을 이용해 제목을 가운데 정렬 했음
ggplot(sexvalue,aes(x = "", y = DayUsedTime, fill = 성별)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y") + geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(성별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(agevalue,aes(x = "", y = DayUsedTime, fill = 연령별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(연령별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(agevalue,aes(x = "", y = DayUsedTime, fill = 연령별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(연령별)") + theme(plot.title = element_text(hjust = 0.6, ))
ggplot(agevalue,aes(x = "", y = DayUsedTime, fill = 연령별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(연령별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(incomevalue,aes(x = "", y = DayUsedTime, fill = 소득별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")), position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(소득별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(marriagevalue,aes(x = "",y = DayUsedTime, fill = 혼인상태별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")), position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(혼인상태별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(areavalue,aes(x = "", y = DayUsedTime, fill = 지역대분류)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")), position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(지역대분류)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(incomevalue,aes(x = "", y = DayUsedTime, fill = 소득별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")), position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(소득별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
sexvalue <- filter(computer, All_Type == "성별")
agevalue <- filter(computer, All_Type == "연령별")
cooperationvalue <- filter(computer,All_Type == "학력별")
incomevalue <- filter(computer,All_Type == "소득별")
marriagevalue <- filter(computer,All_Type == "혼인상태별")
areavalue <- filter(computer,All_Type == "지역대분류")
View(cooperationvalue)
cooperationvalue
cooperation <- c(cooperationvalue)
cooperation
View(coopertaion)
View(cooperation)
View(incomevalue)
View(cooperationvalue)
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
colnames(sexvalue) <- c("All_Type","성별","DayUsedTime")
colnames(agevalue) <- c("All_Type","연령별","DayUsedTime")
colnames(cooperationvalue) <- c("All_Type","학력별","DayUsedTime")
colnames(incomevalue) <- c("All_Type","소득별","DayUsedTime")
colnames(marriagevalue) <- c("All_Type","혼인상태별","DayUsedTime")
colnames(areavalue) <- c("All_Type","지역대분류","DayUsedTime")
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("n") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity")  +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
+ coord_polar("y")
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)", fill=학력별) + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)", fill='학력별') + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(agevalue,aes(x = "", y = DayUsedTime, fill = 연령별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + labs(title = "서울시 1일 평균 인터넷 사용시간(연령별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
+ theme_void()
ggplot(agevalue,aes(x = "", y = DayUsedTime, fill = 연령별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(연령별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5))  + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text( family='notosanskr'))
hjust = 0.6,
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 연령별별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 연령별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 연령별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
##map_g에 표현하기
map_all <- map_g + geom_text(map_text, mapping = aes(x=long, y=lat, label = paste(대분류)), size=2.3, color = 'white')
map_all
test_map
##+ labs(title = "서울시 1일 평균 인터넷 사용시간(성별)")
#그래프 표시 ggplot을 이용해서 그래프 표시, geom_bar를 사용해서 그래프형식으로 만들었다가 coord_polar를 이용해서 pie형식으로 변환,
#geom_text를 이용해서 value의 시간 표시하고 theme_void()를 사용해서 깔끔하게 보이게 함, labs를 이용해 제목표시 했으며 theme을 이용해 제목을 가운데 정렬 했음
ggplot(sexvalue,aes(x = "", y = DayUsedTime, fill = 성별)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y") + geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(성별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(agevalue,aes(x = "", y = DayUsedTime, fill = 연령별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(연령별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(incomevalue,aes(x = "", y = DayUsedTime, fill = 소득별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")), position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(소득별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(marriagevalue,aes(x = "",y = DayUsedTime, fill = 혼인상태별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")), position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(혼인상태별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(areavalue,aes(x = "", y = DayUsedTime, fill = 지역대분류)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")), position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(지역대분류)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
View(cooperationvalue)
ggplot(incomevalue,aes(x = "", y = DayUsedTime, fill = 소득별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")), position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(소득별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
View(cooperationvalue)
View(incomevalue)
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = order(cooperationvalue$학력별))) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
학력별
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = cooperationvalue$학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
#Report_rate.xls를 불러와서 computer에 저장한 후 행이름을 All_Type,Type,DayUsedTime으로 바꿈
computer <- read_excel("~/GitHub/Yonsai_IT_Academy/firstStep/teamproject/Report_rate.xls")
colnames(computer) <- c("All_Type","Type","DayUsedTime")
#computer에서 상황별 값을 뽑아오기 위해 filter함수를 사용함
sexvalue <- filter(computer, All_Type == "성별")
agevalue <- filter(computer, All_Type == "연령별")
cooperationvalue <- filter(computer,All_Type == "학력별")
incomevalue <- filter(computer,All_Type == "소득별")
marriagevalue <- filter(computer,All_Type == "혼인상태별")
areavalue <- filter(computer,All_Type == "지역대분류")
#Data목록 이름 만들어 주기 (fill에 대입될 이름)
colnames(sexvalue) <- c("All_Type","성별","DayUsedTime")
colnames(agevalue) <- c("All_Type","연령별","DayUsedTime")
colnames(cooperationvalue) <- c("All_Type","학력별","DayUsedTime")
colnames(incomevalue) <- c("All_Type","소득별","DayUsedTime")
colnames(marriagevalue) <- c("All_Type","혼인상태별","DayUsedTime")
colnames(areavalue) <- c("All_Type","지역대분류","DayUsedTime")
##+ labs(title = "서울시 1일 평균 인터넷 사용시간(성별)")
#그래프 표시 ggplot을 이용해서 그래프 표시, geom_bar를 사용해서 그래프형식으로 만들었다가 coord_polar를 이용해서 pie형식으로 변환,
#geom_text를 이용해서 value의 시간 표시하고 theme_void()를 사용해서 깔끔하게 보이게 함, labs를 이용해 제목표시 했으며 theme을 이용해 제목을 가운데 정렬 했음
ggplot(sexvalue,aes(x = "", y = DayUsedTime, fill = 성별)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y") + geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(성별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(agevalue,aes(x = "", y = DayUsedTime, fill = 연령별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(연령별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
#Report_rate.xls를 불러와서 computer에 저장한 후 행이름을 All_Type,Type,DayUsedTime으로 바꿈
computer <- read_excel("~/GitHub/Yonsai_IT_Academy/firstStep/teamproject/Report_rate.xls")
colnames(computer) <- c("All_Type","Type","DayUsedTime")
#computer에서 상황별 값을 뽑아오기 위해 filter함수를 사용함
sexvalue <- filter(computer, All_Type == "성별")
agevalue <- filter(computer, All_Type == "연령별")
cooperationvalue <- filter(computer,All_Type == "학력별")
incomevalue <- filter(computer,All_Type == "소득별")
marriagevalue <- filter(computer,All_Type == "혼인상태별")
areavalue <- filter(computer,All_Type == "지역대분류")
#Data목록 이름 만들어 주기 (fill에 대입될 이름)
colnames(sexvalue) <- c("All_Type","성별","DayUsedTime")
colnames(agevalue) <- c("All_Type","연령별","DayUsedTime")
colnames(cooperationvalue) <- c("All_Type","학력별","DayUsedTime")
colnames(incomevalue) <- c("All_Type","소득별","DayUsedTime")
colnames(marriagevalue) <- c("All_Type","혼인상태별","DayUsedTime")
colnames(areavalue) <- c("All_Type","지역대분류","DayUsedTime")
##+ labs(title = "서울시 1일 평균 인터넷 사용시간(성별)")
#그래프 표시 ggplot을 이용해서 그래프 표시, geom_bar를 사용해서 그래프형식으로 만들었다가 coord_polar를 이용해서 pie형식으로 변환,
#geom_text를 이용해서 value의 시간 표시하고 theme_void()를 사용해서 깔끔하게 보이게 함, labs를 이용해 제목표시 했으며 theme을 이용해 제목을 가운데 정렬 했음
ggplot(sexvalue,aes(x = "", y = DayUsedTime, fill = 성별)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y") + geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(성별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(agevalue,aes(x = "", y = DayUsedTime, fill = 연령별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(연령별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(incomevalue,aes(x = "", y = DayUsedTime, fill = 소득별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")), position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(소득별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(marriagevalue,aes(x = "",y = DayUsedTime, fill = 혼인상태별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")), position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(혼인상태별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(areavalue,aes(x = "", y = DayUsedTime, fill = 지역대분류)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")), position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(지역대분류)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
library(readxl)
library(dplyr)
library(XML)
library(jsonlite)
library(ggplot2)
library(psych)
library(reshape2)
library(stringr)
#Report_rate.xls를 불러와서 computer에 저장한 후 행이름을 All_Type,Type,DayUsedTime으로 바꿈
computer <- read_excel("~/GitHub/Yonsai_IT_Academy/firstStep/teamproject/Report_rate.xls")
colnames(computer) <- c("All_Type","Type","DayUsedTime")
#computer에서 상황별 값을 뽑아오기 위해 filter함수를 사용함
sexvalue <- filter(computer, All_Type == "성별")
agevalue <- filter(computer, All_Type == "연령별")
cooperationvalue <- filter(computer,All_Type == "학력별")
incomevalue <- filter(computer,All_Type == "소득별")
marriagevalue <- filter(computer,All_Type == "혼인상태별")
areavalue <- filter(computer,All_Type == "지역대분류")
#Data목록 이름 만들어 주기 (fill에 대입될 이름)
colnames(sexvalue) <- c("All_Type","성별","DayUsedTime")
colnames(agevalue) <- c("All_Type","연령별","DayUsedTime")
colnames(cooperationvalue) <- c("All_Type","학력별","DayUsedTime")
colnames(incomevalue) <- c("All_Type","소득별","DayUsedTime")
colnames(marriagevalue) <- c("All_Type","혼인상태별","DayUsedTime")
colnames(areavalue) <- c("All_Type","지역대분류","DayUsedTime")
##+ labs(title = "서울시 1일 평균 인터넷 사용시간(성별)")
#그래프 표시 ggplot을 이용해서 그래프 표시, geom_bar를 사용해서 그래프형식으로 만들었다가 coord_polar를 이용해서 pie형식으로 변환,
#geom_text를 이용해서 value의 시간 표시하고 theme_void()를 사용해서 깔끔하게 보이게 함, labs를 이용해 제목표시 했으며 theme을 이용해 제목을 가운데 정렬 했음
ggplot(sexvalue,aes(x = "", y = DayUsedTime, fill = 성별)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y") + geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(성별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
library(showtext)
showtext.auto()
o
##+ labs(title = "서울시 1일 평균 인터넷 사용시간(성별)")
#그래프 표시 ggplot을 이용해서 그래프 표시, geom_bar를 사용해서 그래프형식으로 만들었다가 coord_polar를 이용해서 pie형식으로 변환,
#geom_text를 이용해서 value의 시간 표시하고 theme_void()를 사용해서 깔끔하게 보이게 함, labs를 이용해 제목표시 했으며 theme을 이용해 제목을 가운데 정렬 했음
ggplot(sexvalue,aes(x = "", y = DayUsedTime, fill = 성별)) + geom_bar(width = 1, stat = "identity") +
coord_polar("y") + geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(성별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(agevalue,aes(x = "", y = DayUsedTime, fill = 연령별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(연령별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(cooperationvalue,aes(x = "", y = DayUsedTime, fill = 학력별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")),position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(학력별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(incomevalue,aes(x = "", y = DayUsedTime, fill = 소득별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")), position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(소득별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(marriagevalue,aes(x = "",y = DayUsedTime, fill = 혼인상태별)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")), position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(혼인상태별)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
ggplot(areavalue,aes(x = "", y = DayUsedTime, fill = 지역대분류)) + geom_bar(width = 1, stat = "identity") + coord_polar("y") +
geom_text(aes(label = paste0(round(DayUsedTime,10),"시간")), position = position_stack(vjust = 0.5)) + theme_void() + labs(title = "서울시 1일 평균 인터넷 사용시간(지역대분류)") + theme(plot.title = element_text(hjust = 0.6, family='notosanskr'))
library(ggmap)
library(ggplot2)
library(raster)
library(rgeos)
library(maptools)
library(rgdal)
library(ggmap)
register_google(key = 'AIzaSyClyDsfhdF4-XZcaBQOY-mKj1rmp4LM2NE')
##----------------------------data test-------------------------
map <- shapefile("~/GitHub/Yonsai_IT_Academy/firstStep/teamproject/SIG_201703/TL_SCCO_SIG.shp")
map <- spTransform(map, CRSobj = CRS('+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs'))
new_map <- fortify(map, region = "SIG_CD")
View(new_map)
new_map$id <- as.numeric(new_map$id)
seoul_map <- new_map[new_map$id <= 11740,]
View(seoul_map)
library(readxl)
data <- read_xls("~/GitHub/Yonsai_IT_Academy/firstStep/teamproject/Report.xls")
View(data)
internet_data <- data
library(dplyr)
##Report.xls에사 대분류에서 구로 끝나는 데이터 행 추출
internet_data <- internet_data[grep("구", internet_data$대분류),]
View(internet_data)
##구로 끝나는 데이터 행에서 1~3까지 데이터 열만 추출
internet_data <- internet_data[,c(1:3)]
View(internet_data)
##분류(2열) 열 삭제
internet_data <- internet_data[,-c(2)]
View(internet_data)
##인터넷 데이터의 "1일평균사용시간(시간) 열 이름을 "하루평균사용시간"으로 변경
##변경 이유 : string + int가 합쳐져 1이 int로 인식
internet_data <- rename(internet_data,"하루평균사용시간" = "1일평균사용시간(시간)")
##맵데이터와 internet_data를 연결하기 위해 id 값을 추가
internet_data[,'id'] <- c(11110,11140, 11170, 11200, 11215, 11230, 11260, 11290, 11305, 11320, 11350, 11380, 11410, 11440, 11470, 11500, 11530, 11545, 11560, 11590, 11620, 11650, 11680, 11710, 11740)
View(internet_data)
##seoul_map과 internet_data 값을 id로 병합 연결
merge_result <- merge(seoul_map, internet_data, by="id")
View(merge_result)
map_g <- ggplot() + geom_polygon(data=merge_result, aes(x=long, y=lat, group=group, fill=하루평균사용시간), color = 'white') + labs(x='위도', y='경도', fill='인터넷 하루평균사용시간') + scale_fill_gradient(low='#4374D9', high='#000042')
map_g
##지도에 text 삽입을 위한 데이터 가공
map_text <- internet_data
map_text[,'lat'] <- c(mean(merge_result[grep("종로구", merge_result$대분류),]$lat), mean(merge_result[grep("중구", merge_result$대분류),]$lat), mean(merge_result[grep("용산구", merge_result$대분류),]$lat)-0.002, mean(merge_result[grep("성동구", merge_result$대분류),]$lat), mean(merge_result[grep("광진구", merge_result$대분류),]$lat), mean(merge_result[grep("동대문구", merge_result$대분류),]$lat), mean(merge_result[grep("중랑구", merge_result$대분류),]$lat), mean(merge_result[grep("성북구", merge_result$대분류),]$lat), mean(merge_result[grep("강북구", merge_result$대분류),]$lat), mean(merge_result[grep("도봉구", merge_result$대분류),]$lat), mean(merge_result[grep("노원구", merge_result$대분류),]$lat), mean(merge_result[grep("은평구", merge_result$대분류),]$lat), mean(merge_result[grep("서대문구", merge_result$대분류),]$lat), mean(merge_result[grep("마포구", merge_result$대분류),]$lat)-0.005, mean(merge_result[grep("양천구", merge_result$대분류),]$lat)-0.01, mean(merge_result[grep("강서구", merge_result$대분류),]$lat), mean(merge_result[grep("구로구", merge_result$대분류),]$lat)+0.005, mean(merge_result[grep("금천구", merge_result$대분류),]$lat)+0.002, mean(merge_result[grep("영등포구", merge_result$대분류),]$lat), mean(merge_result[grep("동작구", merge_result$대분류),]$lat)+0.01, mean(merge_result[grep("관악구", merge_result$대분류),]$lat), mean(merge_result[grep("서초구", merge_result$대분류),]$lat), mean(merge_result[grep("강남구", merge_result$대분류),]$lat), mean(merge_result[grep("송파구", merge_result$대분류),]$lat), mean(merge_result[grep("강동구", merge_result$대분류),]$lat))
map_text[,'long'] <- c(mean(merge_result[grep("종로구", merge_result$대분류),]$long), mean(merge_result[grep("중구", merge_result$대분류),]$long), mean(merge_result[grep("용산구", merge_result$대분류),]$long), mean(merge_result[grep("성동구", merge_result$대분류),]$long)+0.015, mean(merge_result[grep("광진구", merge_result$대분류),]$long), mean(merge_result[grep("동대문구", merge_result$대분류),]$long), mean(merge_result[grep("중랑구", merge_result$대분류),]$long), mean(merge_result[grep("성북구", merge_result$대분류),]$long), mean(merge_result[grep("강북구", merge_result$대분류),]$long), mean(merge_result[grep("도봉구", merge_result$대분류),]$long), mean(merge_result[grep("노원구", merge_result$대분류),]$long)+0.01, mean(merge_result[grep("은평구", merge_result$대분류),]$long), mean(merge_result[grep("서대문구", merge_result$대분류),]$long)-0.005, mean(merge_result[grep("마포구", merge_result$대분류),]$long), mean(merge_result[grep("양천구", merge_result$대분류),]$long)-0.002, mean(merge_result[grep("강서구", merge_result$대분류),]$long), mean(merge_result[grep("구로구", merge_result$대분류),]$long), mean(merge_result[grep("금천구", merge_result$대분류),]$long)+0.002, mean(merge_result[grep("영등포구", merge_result$대분류),]$long)+0.005, mean(merge_result[grep("동작구", merge_result$대분류),]$long), mean(merge_result[grep("관악구", merge_result$대분류),]$long), mean(merge_result[grep("서초구", merge_result$대분류),]$long), mean(merge_result[grep("강남구", merge_result$대분류),]$long), mean(merge_result[grep("송파구", merge_result$대분류),]$long), mean(merge_result[grep("강동구", merge_result$대분류),]$long))
##map_g에 표현하기
map_all <- map_g + geom_text(map_text, mapping = aes(x=long, y=lat, label = paste(대분류)), size=2.3, color = 'white')
map_all
base_map = get_map("seoul", zoom=11, maptype = "hybrid")
ggmap(base_map)
test_map <- ggmap(base_map)+geom_polygon(data=merge_result, aes(x=long, y=lat, group=group, fill=하루평균사용시간),alpha = 0.5, color = 'white') + labs(x='위도', y='경도', fill='하루평균사용시간', color='서울특별시 자치구')+ scale_fill_gradient(low='#4374D9', high='#000042')
test_map
library(jsonlite)
library(dplyr)
library(ggplot2)
url = "https://api.bithumb.com/public/ticker/all"
coinTable <- jsonlite::read_json(url)
View(coinTable)
View(coinTable$BTC)
coinTable
coinTable$XRP
coinTable$xrp
coinTable["xrp"]
coinTable["XRP"]
coinTable["data"]$data$XRP
View(coinTable["data"]$data$XRP)
typeof(coinTable$data$XRP$opening_price)
typeof(coinTable["data"]$data$XRP$opening_price)
typeof(coinTable$data$XRP$closing_price)
typeof(coinTable$data$XRP$closing_price)
xrp_table <- data.frame(coinTable$data$XRP)
View(xrp_table)
xrp_table <- data.frame(coinTable$data$XRP, coinTable$data$BTC, coinTable$data$ETC)
View(xrp_table)
etc_table <- data.frame(coinTable$dat$ETC)
btc_table <- data.frame(coinTable$data$BTC)
View(btc_table)
View(etc_table)
coin_total <- btc_table + xrt_table + etc_table
coin_total <- btc_table + xrp_table + etc_table
View(coin_total)
coin_total <- rbind(btc_table, xrp_table, etc_table)
View(coin_total)
View(coinTable$data)
coin_total <- data.frame(coinTable$dat.NAME)
View(coin_total)
coinTable <- fromJSON(url)
View(coinTable$data)
View(coinTable)
coinTable <- coinTable$data ; data
coinTable <- coinTable$data ; data
coinTable <- coinTable$data
View(coinTable)
coinTable <- coinTable$data ; coinTable
View(coinTable)
View(coinTable)
library(jsonlite)
coinTable <- read_json(url)
coinTable <- fromJSON(url)
coinTable <- fromJSON("https://api.bithumb.com/public/ticker/ALL")
View(coinTable)
library(dplyr)
xrpData <- coinTable$data$XRP
View(xrpData)
xrpData <- coinTable$data; coinTable
View(xrpData)
View(coinTable)
View(coinData)
coinData <- coinTable$data; coinTable
View(coinData)
coinRate <- data.frame(grep["fluctate_rate_24H",coinData])
write.csv(coinData, file="coinData.csv")
xrpData <- coinData$XRP
View(xrpData)
write.csv(xrpData, file = "xrpData.csv")
View(coinData)
coinDataFrame <- coinData[, (0:)]
coinDataFrame <- data.frame(grep("\w", coinData))
coinDataFrame <- data.frame(grep(\w, coinData))
coinDataFrame <- data.frame(grep("/w", coinData))
View(cointDataFrame)
View(coinDataFrame)
coinDataFrame <- data.frame(grep(a*, coinData))
coinDataFrame <- data.frame(grep("a*", coinData))
View(coinDataFrame)
coinDataFrame <- data.frame(grep('B+|X+|E+', coinData))
View(coinDataFrame)
coinDataFrame <- coinData('B+|X+|E+')
coinDataFrame <- coinData('B+|X+')
coinDataFrame <- grep('B | X', coinData)
View(coinDataFrame)
coinDataFrame <- grep('B', coinData)
View(coinDataFrame)
coinData <- coinTable$data; coinTable
coinDataFrame <- grep('B', coinData)
View(coinDataFrame)
coinDataFrame <- grep('fluctate_rate_24H', coinData)
View(coinDataFrame)
coinDataFrame
coinDataFrame <- grep('fluctate_rate_24H', coinData, value=T)
View(coinDataFrame)
write.csv(coinDataFrame, file = "coinData.csv")
unlist(coinData)
coinDataFrame <- grep('fluctate_rate_24H', coinData, value=T)
View(coinDataFrame)
coinData <- coinTable$data; coinTable
coinDataFrame <- unlist(grep('fluctate_rate_24H', coinData, value=T))
View(coinDataFrame)
write.csv(coinDataFrame, file = "coinData.csv")
write.csv(coinDataFrame, file = "coinData(1).csv")
coinTable <- fromJSON("https://api.bithumb.com/public/ticker/ALL")
View(coinTable)
View(coinTable)
write.csv(coinData, file = "coinTotalData.csv")
